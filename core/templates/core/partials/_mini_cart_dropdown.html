{# core/templates/core/partials/_mini_cart_dropdown.html #}

{% load static %}

<li class="nav-item dropdown position-relative me-2">

  <!-- ICONO DEL CARRITO -->
  <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="miniCartMenu"
     role="button" data-bs-toggle="dropdown" aria-expanded="false">

    <i class="bi bi-cart3 fs-5"></i>

    {% if cart_count > 0 %}
      <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
        {{ cart_count }}
      </span>
    {% endif %}
  </a>

  <!-- CONTENIDO DEL DROPDOWN -->
  <div class="dropdown-menu dropdown-menu-end p-0 shadow-lg" aria-labelledby="miniCartMenu"
       style="min-width: 340px; border-radius: 10px; overflow:hidden;">

    <!-- HEADER -->
    <div class="p-3 bg-dark text-white d-flex justify-content-between align-items-center">
      <strong>ðŸ›’ Mi carrito</strong>
      <small class="text-light-50">{{ cart_count }} item{{ cart_count|pluralize:"s" }}</small>
    </div>

    {% if items %}
      <!-- LISTA DE ITEMS -->
      <ul class="list-group list-group-flush">
        {% for it in items %}
          <li class="list-group-item d-flex justify-content-between align-items-start">

            <!-- INFO -->
            <div class="me-2">
              <div class="fw-semibold">{{ it.cancha }}</div>

              <div class="small text-muted">
                {{ it.hora_inicio|date:"d-m H:i" }} â€“ {{ it.hora_fin|date:"H:i" }}
              </div>
            </div>

            <!-- PRECIO -->
            <div class="text-end fw-bold text-success">
              ${{ it.precio|floatformat:0 }}
            </div>
          </li>
        {% endfor %}
      </ul>

      <!-- SUBTOTAL -->
      <div class="p-3 bg-light border-top">
        <div class="d-flex justify-content-between mb-3">
          <strong>Subtotal</strong>
          <span class="fw-bold">${{ subtotal|floatformat:0 }}</span>
        </div>

        <!-- BOTONES -->
        <div class="d-flex gap-2">
          
          <!-- VER CARRITO -->
          <a class="btn btn-sm btn-outline-secondary w-50" 
             href="{% url 'ver_carrito' %}">
            Ver carrito
          </a>
        </div>
      </div>

    {% else %}
      <!-- CARRITO VACÃO -->
      <div class="p-4 text-center">
        <p class="text-muted mb-2">Tu carrito estÃ¡ vacÃ­o.</p>
        <a class="btn btn-sm btn-primary w-100" href="{% url 'ver_carrito' %}">
          Ver carrito
        </a>
      </div>
    {% endif %}

  </div>

</li>
